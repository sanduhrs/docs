<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Learning Locker Documentation</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Documentation for Learning Locker, the open source learning record store.">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/tomorrow-night.css">
    <link rel="stylesheet" href="../css/docs.css">

    <script async="" src="//www.google-analytics.com/analytics.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-941797-7', 'learninglocker.net');
        ga('send', 'pageview');

    </script>
    <script type="text/javascript">
        function prettyCode() {
            var tables = document.getElementsByTagName('table');
            for (index = 0; index < tables.length; ++index) {
                tables[index].className = "table table-default table-bordered";
            }
        }
    </script>
</head>


    <body onload="prettyCode();">

    <div class="docs-masthead">
    <div class="container">
        <img src="../images/logo-small.png" class="logo">
        <nav class="docs-nav pull-right">
            <a class="docs-nav-item" href="http://learninglocker.net">Website</a>
            <a class="docs-nav-item" href="https://github.com/learninglocker">Github</a>
            <a class="docs-nav-item" href="https://github.com/learninglocker/docs">Edit</a>
        </nav>
    </div>
</div>


    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-3 docs-sidebar">
                <div class="sidebar-title">
                    <a href="../welcome">Getting Started</a>
                </div>
                <ul class="nav">
                    <li><a href="../installation">Installing</a></li>
                    <li><a href="../troubleshooting">Troubleshooting</a></li>
                    <li><a href="../upgrading">Upgrading</a></li>
                    <li><a href="../contribute">Contributing</a></li>
                    <li><a href="../contributors">Contributors</a></li>
                </ul>
                <div class="sidebar-title">
                    <a href="#">User Interfaces</a>
                </div>
                <ul class="nav">
                    <li><a href="../administration">Administration</a></li>
                    <li><a href="../reporting">Reports</a></li>
                    <li><a href="../exporting">Exports</a></li>
                </ul>
                <div class="sidebar-title">
                    <a href="../postman">HTTP Interfaces (APIs)</a>
                </div>
                <ul class="nav">
                    <li><a href="../analytics_api">Analytics</a></li>
                    <li><a href="../statements_api">Aggregation</a></li>
                    <li><a href="../report_api">Reports</a></li>
                    <li><a href="../exports_api">Exports</a></li>
                </ul>
            </div>
            <div class="col-xs-12 col-sm-8 docs-main">
                <h1 id="query-analytics-api">Query (Analytics) API</h1>

<p>The purpose of this custom API is to provide developers building reporting type tools with a few additional views of the data within an LRS.</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>HTTP request</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#analytics">analytics</a></td>
      <td>GET /analytics</td>
      <td><strong>Deprecated.</strong> Gets an aggregated query of the statements.</td>
    </tr>
  </tbody>
</table>

<p><em>URIs relative to http://www.example.com/api/v1/query/, unless otherwise noted. Additionally you must supply your Basic Auth details with each request. Your Basic Auth details can be found under “xAPI Statements” in your LRS’s settings.</em></p>

<h2 id="analytics">analytics</h2>
<p><strong>Deprecated</strong> - use <a href="../statements_api#aggregate">aggregate</a> instead.</p>

<p><code>
GET http://www.example.com/api/v1/query/analytics
</code></p>

<h3 id="parameters">Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>filter</strong></td>
      <td><a href="#queryfilter">QueryFilter</a></td>
      <td>The filters that the statements must pass.</td>
    </tr>
    <tr>
      <td>type</td>
      <td><a href="#querytype">QueryType</a></td>
      <td>Type of grouping applied (defaults to “time”).</td>
    </tr>
    <tr>
      <td>interval</td>
      <td><a href="#queryinterval">QueryInterval</a></td>
      <td>Time grouping, only applicable when <code>type</code> = time (defaults to “day”).</td>
    </tr>
    <tr>
      <td>since</td>
      <td><a href="#querydate">QueryDate</a></td>
      <td>Date to begin returning statements.</td>
    </tr>
    <tr>
      <td>until</td>
      <td><a href="#querydate">QueryDate</a></td>
      <td>Date to stop returning statements.</td>
    </tr>
  </tbody>
</table>

<p><em>Required parameters are shown in <strong>bold</strong>.</em></p>

<h3 id="example">Example</h3>

<pre><code>GET http://www.example.com/api/v1/query/analytics?type=time&amp;interval=day&amp;since=2015-01-01&amp;until=2015-01-02&amp;filter={
  "context.contextActivities.grouping.type": "course",
  "object.definition.type": "http://activitystrea.ms/schema/1.0/badge",
  "context.contextActivities.grouping.tags": [
    ["foo", "bar"], 
    "hello",
    "world"
  ],
  "result.score.raw": ["&lt;&gt;", 0.6, 0.8]
}
</code></pre>

<p>This example would look to return data where the grouping is a ‘course’, the object definition type is ‘badge’ and grouping tags are equal to ‘foo’ or ‘bar’ and ‘hello’ and ‘world’. And where the raw result score is between 0.6 and 0.8.</p>

<h2 id="parameter-types">Parameter Types</h2>

<h3 id="queryfilter">QueryFilter</h3>
<p>Object, where the <code>key</code> is a <code>path</code> and the <code>value</code> is the <code>filter</code>. A <code>filter</code> can be either:</p>

<ul>
  <li>Array of 3 items where the first is “&lt;&gt;”. This will return objects where the <code>path</code> is between the value of the 2nd item and 3rd item (where the 3rd item is the greatest).</li>
  <li>Array of values. This will return objects where the <code>path</code> is equal to any of the items in the Array.</li>
  <li>String.</li>
  <li>Number.</li>
  <li>Boolean.</li>
  <li>Object.</li>
</ul>

<h3 id="querytype">QueryType</h3>
<p>String containing either:</p>

<ul>
  <li>“time”: return an array of dates with a count for how many filtered statements occurred in a defined interval  (day, week, month, year)</li>
  <li>“user”: return an array of actors with a count for how many filtered statements occurred for each activity: return an array of activities with a count for how many filtered statements occurred for each</li>
  <li>“verb”: return an array of verbs with a count for how many filtered statements occurred for each</li>
</ul>

<h3 id="queryinterval">QueryInterval</h3>
<p>String containing either:</p>

<ul>
  <li>“day”</li>
  <li>“week”</li>
  <li>“month”</li>
  <li>“year”</li>
</ul>

<h3 id="querydate">QueryDate</h3>
<p>String of the form YYYY-MM-DD.</p>

            </div>
        </div>
    </div>

    <footer class="docs-footer">
    <p>Learning Locker and the Squirrel logo are copyright HT2, 2014 | Learning Locker is licensed under GPL 3.0.</p>
    <p>
        <a href="#">Back to top</a>
    </p>
</footer>


    </body>
</html>
